(()=>{"use strict";var e={132:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.once=t.toggleInSet=t.removeFromSet=t.addToSet=t.binarySearch=void 0,t.binarySearch=function(e,t){let o=0,n=e.length-1;for(;o<=n;){const i=(o+n)/2|0,r=t(e[i]);if(r<0)o=i+1;else{if(!(r>0))return i;n=i-1}}return-(o+1)},t.addToSet=(e,t)=>{const o=new Set([...e,t]);return o.add(t),o},t.removeFromSet=(e,t)=>{const o=new Set([...e]);return o.delete(t),o},t.toggleInSet=(e,t)=>{const o=new Set([...e]);return o.has(t)?o.delete(t):o.add(t),o};const o=Symbol("unset");t.once=e=>{let t=o;return()=>(t===o&&(t=e()),t)}},85:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bundlePage=void 0;const n=o(412);t.bundlePage=async(e,t)=>{const o=(0,n.makeNonce)();return`<!DOCTYPE html>\n    <html lang="en">\n    <head>\n      <meta charset="UTF-8">\n      <meta name="viewport" content="width=device-width, initial-scale=1.0">\n      ${(0,n.nonceHeader)(o)}\n      <title>Profile Custom Editor</title>\n    </head>\n    <body>\n      <script type="text/javascript" nonce="${o}">\n        ${Object.entries(t).map((([e,t])=>`globalThis.${e} = ${JSON.stringify(t)}`)).join(";")}\n      <\/script>\n      <script nonce="${o}" src="${e}"><\/script>\n    </body>\n    </html>\n  `}},639:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.categorize=void 0,t.categorize=(e,t)=>(e.functionName=e.functionName||"(anonymous)",e.lineNumber<0?0:e.url.includes("node_modules")||!t?2:1)},49:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CpuProfileAnnotations=void 0;const n=o(496),i=o(561),r=o(127),s=o(65);class a extends r.ProfileAnnotations{constructor(){super(...arguments),this.data=new Map}set(e,t,o){var r;let s=this.data.get((0,i.lowerCaseInsensitivePath)(e));s||(s=[],this.data.set((0,i.lowerCaseInsensitivePath)(e),s));let a=0;for(;a<s.length&&s[a].position.line<t.line;)a++;if((null===(r=s[a])||void 0===r?void 0:r.position.line)===t.line){const e=s[a];t.character<e.position.character&&(e.position=new n.Position(t.line,t.character)),e.data.aggregateTime+=o.aggregateTime,e.data.selfTime+=o.selfTime,e.data.ticks+=o.ticks}else s.splice(a,0,{position:new n.Position(t.line,t.character),data:{aggregateTime:o.aggregateTime,selfTime:o.selfTime,ticks:o.ticks}})}getLensesForFile(e){var t,o;return this.expandForFile(e),null!==(o=null===(t=this.data.get((0,i.lowerCaseInsensitivePath)(e)))||void 0===t?void 0:t.map((({position:e,data:t})=>{if(0===t.aggregateTime&&0===t.selfTime)return[];const o=new n.Range(e,e);return[new n.CodeLens(o,{title:`${s.decimalFormat.format(t.selfTime/1e3)}ms Self Time, ${s.decimalFormat.format(t.aggregateTime/1e3)}ms Total`,command:""}),new n.CodeLens(o,{title:"Clear",command:"extension.jsProfileVisualizer.table.clearCodeLenses"})]})).reduce(((e,t)=>[...e,...t]),[]))&&void 0!==o?o:[]}}t.CpuProfileAnnotations=a},65:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decimalFormat=void 0,t.decimalFormat=new Intl.NumberFormat(void 0,{maximumFractionDigits:2,minimumFractionDigits:2})},577:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CpuProfileEditorProvider=void 0;const s=r(o(496)),a=o(85),l=o(650),c=o(79),u=o(802),d=o(49),m=o(864);t.CpuProfileEditorProvider=class{constructor(e,t,o={}){this.lens=e,this.bundle=t,this.extraConsts=o,this.onDidChangeCustomDocument=(new s.EventEmitter).event}async openCustomDocument(e){const t=await s.workspace.fs.readFile(e),o=JSON.parse((new TextDecoder).decode(t)),n=new c.ReadonlyCustomDocument(e,(0,m.buildModel)(o)),i=new d.CpuProfileAnnotations,r=n.userData.rootPath;for(const e of n.userData.locations)i.add(r,e);return this.lens.registerLenses(i),n}async resolveCustomEditor(e,t){t.webview.onDidReceiveMessage((t=>{var o;switch(t.type){case"openDocument":return void(0,l.openLocation)({rootPath:null===(o=e.userData)||void 0===o?void 0:o.rootPath,viewColumn:t.toSide?s.ViewColumn.Beside:s.ViewColumn.Active,callFrame:t.callFrame,location:t.location});case"reopenWith":return void(0,u.reopenWithEditor)(e.uri,t.viewType,t.requireExtension);default:console.warn(`Unknown request from webview: ${JSON.stringify(t)}`)}})),t.webview.options={enableScripts:!0},t.webview.html=await(0,a.bundlePage)(t.webview.asWebviewUri(this.bundle),{MODEL:e.userData,...this.extraConsts})}async saveCustomDocument(){}async revertCustomDocument(){}async backupCustomDocument(){return{id:"",delete:()=>{}}}saveCustomDocumentAs(e,t){return s.workspace.fs.copy(e.uri,t,{overwrite:!0})}}},864:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildModel=void 0;const n=o(639),i=o(460),r=o(561),s=(e,t)=>{const o=t[e];if(o.aggregateTime)return o.aggregateTime;let n=o.selfTime;for(const e of o.children)n+=s(e,t);return o.aggregateTime=n};t.buildModel=e=>{var t,o,a;if(!e.timeDeltas||!e.samples)return{nodes:[],locations:[],samples:e.samples||[],timeDeltas:e.timeDeltas||[],rootPath:null===(t=e.$vscode)||void 0===t?void 0:t.rootPath,duration:e.endTime-e.startTime};const{samples:l,timeDeltas:c}=e,u=(e=>{var t;if(e.$vscode)return e.$vscode.locations;let o=0;const n=new Map,i=e=>{const t=[e.functionName,e.url,e.scriptId,e.lineNumber,e.columnNumber].join(":"),i=n.get(t);if(i)return i.id;const s=o++;return n.set(t,{id:s,callFrame:e,location:{lineNumber:e.lineNumber+1,columnNumber:e.columnNumber+1,source:{name:(0,r.maybeFileUrlToPath)(e.url),path:(0,r.maybeFileUrlToPath)(e.url),sourceReference:0}}}),s};for(const o of e.nodes)o.locationId=i(o.callFrame),o.positionTicks=null===(t=o.positionTicks)||void 0===t?void 0:t.map((e=>({...e,startLocationId:i({...o.callFrame,lineNumber:e.line-1,columnNumber:0}),endLocationId:i({...o.callFrame,lineNumber:e.line,columnNumber:0})})));return[...n.values()].sort(((e,t)=>e.id-t.id)).map((e=>({locations:[e.location],callFrame:e.callFrame})))})(e),d=u.map(((t,o)=>{const r=(0,i.getBestLocation)(e,t.locations);return{id:o,selfTime:0,aggregateTime:0,ticks:0,category:(0,n.categorize)(t.callFrame,r),callFrame:t.callFrame,src:r}})),m=new Map,h=e=>{let t=m.get(e);return void 0===t&&(t=m.size,m.set(e,t)),t},f=new Array(e.nodes.length);for(let t=0;t<e.nodes.length;t++){const n=e.nodes[t],i=h(n.id);f[i]={id:i,selfTime:0,aggregateTime:0,locationId:n.locationId,children:(null===(o=n.children)||void 0===o?void 0:o.map(h))||[]};for(const e of n.positionTicks||[])e.startLocationId&&(d[e.startLocationId].ticks+=e.ticks)}for(const e of f)for(const t of e.children)f[t].parent=e.id;const p=e.endTime-e.startTime;let v=p-c[0];for(let e=0;e<c.length-1;e++){const t=c[e+1];f[h(l[e])].selfTime+=t,v-=t}f.length&&(f[h(l[c.length-1])].selfTime+=v,c.push(v));for(let e=0;e<f.length;e++){const t=f[e],o=d[t.locationId];o.aggregateTime+=s(e,f),o.selfTime+=t.selfTime}return{nodes:f,locations:d,samples:l.map(h),timeDeltas:c,rootPath:null===(a=e.$vscode)||void 0===a?void 0:a.rootPath,duration:p}}},354:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DownloadFileProvider=void 0;const s=r(o(496));class a{async provideTextDocumentContent(e){return s.window.withProgress({location:s.ProgressLocation.Notification,title:`Retrieving ${e.query}...`},(async()=>{try{const t=await fetch(e.query,{}),o=await t.text();return t.ok?o:`Unexpected ${t.status} from ${e.query}: ${o}`}catch(e){return e.message}}))}}t.DownloadFileProvider=a,a.scheme="js-viz-download"},171:(e,t,o)=>{o.r(t),o.d(t,{HeapSnapshotEditorProvider:()=>c});var n=o(496);const i=require("worker_threads");var r,s;class a{constructor(e,t){this.uri=e,this.value=t}dispose(){this.value.dispose()}}const l=null!==(r=(s=globalThis).__jsHeapSnapshotWorkers)&&void 0!==r?r:s.__jsHeapSnapshotWorkers=new class{constructor(){this.workers=new Map}async create(e){let t=this.workers.get(e.with({query:""}).toString());if(!t){const o=await(async e=>{const t=new i.Worker(`${__dirname}/heapsnapshotWorker.js`,{workerData:"file"===e.scheme?e.fsPath:await n.workspace.fs.readFile(e)});return{postMessage:e=>t.postMessage(e),onMessage:e=>(t.on("message",e),{dispose:()=>t.off("message",e)}),terminate:async()=>{await t.terminate()}}})(e);t={worker:o,rc:0},this.workers.set(e.toString(),t)}return t.rc++,t.closer&&(clearTimeout(t.closer),t.closer=void 0),{worker:t.worker,dispose:()=>{--t.rc||(t.closer=setTimeout((()=>{t.worker.terminate(),this.workers.delete(e.toString())}),5e3))}}}};class c{constructor(e,t={}){this.bundle=e,this.extraConsts=t,this.onDidChangeCustomDocument=(new n.EventEmitter).event}async openCustomDocument(e){const t=await l.create(e);return new a(e,t)}async resolveCustomEditor(e,t){t.webview.onDidReceiveMessage((t=>{switch(t.type){case"reopenWith":return o=e.uri.with({query:t.withQuery}),i=t.viewType,r=t.requireExtension,s=t.toSide,void(r&&!n.extensions.all.some((e=>e.id===r))?n.commands.executeCommand("workbench.extensions.action.showExtensionsWithIds",[r]):n.commands.executeCommand("vscode.openWith",o,i,s?n.ViewColumn.Beside:n.ViewColumn.Active));case"callGraph":return void e.value.worker.postMessage(t.inner);default:console.warn(`Unknown request from webview: ${JSON.stringify(t)}`)}var o,i,r,s}));const o=e.value.worker.onMessage((e=>{t.webview.postMessage({method:"graphRet",message:e})}));t.onDidDispose((()=>{o.dispose()})),t.webview.options={enableScripts:!0},t.webview.html=await(async(e,t)=>{const o=function(e=32){let t="";for(let o=0;o<e;o++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[Math.floor(62*Math.random())];return t}();return`<!DOCTYPE html>\n    <html lang="en">\n    <head>\n      <meta charset="UTF-8">\n      <meta name="viewport" content="width=device-width, initial-scale=1.0">\n      ${(e=>`<meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline'; script-src 'nonce-${e}';">`)(o)}\n      <title>Profile Custom Editor</title>\n    </head>\n    <body>\n      <script type="text/javascript" nonce="${o}">\n        ${Object.entries(t).map((([e,t])=>`globalThis.${e} = ${JSON.stringify(t)}`)).join(";")}\n      <\/script>\n      <script nonce="${o}" src="${e}"><\/script>\n    </body>\n    </html>\n  `})(t.webview.asWebviewUri(this.bundle),{SNAPSHOT_URI:t.webview.asWebviewUri(e.uri).toString(),DOCUMENT_URI:e.uri.toString(),...this.extraConsts})}async saveCustomDocument(){}async revertCustomDocument(){}async backupCustomDocument(){return{id:"",delete:()=>{}}}saveCustomDocumentAs(e,t){return n.workspace.fs.copy(e.uri,t,{overwrite:!0})}}},460:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBestLocation=void 0;const n=o(59);t.getBestLocation=(e,t=[])=>{var o;if(!(null===(o=e.$vscode)||void 0===o?void 0:o.rootPath))return t[0];for(const o of t){const t=(0,n.addRelativeDiskPath)(e.$vscode.rootPath,o);if(t.relativePath)return t}return t[0]}},583:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decimalFormat=void 0,t.decimalFormat=new Intl.NumberFormat(void 0,{maximumFractionDigits:0,minimumFractionDigits:0})},849:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HeapProfileEditorProvider=void 0;const s=r(o(496)),a=o(85),l=o(650),c=o(79),u=o(802),d=o(227),m=o(970),h=o(242);t.HeapProfileEditorProvider=class{constructor(e,t,o={}){this.lens=e,this.bundle=t,this.extraConsts=o,this.onDidChangeCustomDocument=(new s.EventEmitter).event}async openCustomDocument(e){const t=await s.workspace.fs.readFile(e),o=JSON.parse((new TextDecoder).decode(t)),n=new c.ReadonlyCustomDocument(e,(0,m.buildModel)(o)),i=(0,h.createTree)(n.userData),r=[i];let a=[i];for(;a.length;){const e=a.pop();e&&(r.push(e),a=a.concat(Object.values(e.children)))}const l=new d.HeapProfileAnnotations,u=n.userData.rootPath;for(const e of r)l.add(u,e);return this.lens.registerLenses(l),n}async resolveCustomEditor(e,t){t.webview.onDidReceiveMessage((t=>{switch(t.type){case"openDocument":return void(0,l.openLocation)({rootPath:void 0,viewColumn:t.toSide?s.ViewColumn.Beside:s.ViewColumn.Active,callFrame:t.callFrame,location:t.location});case"reopenWith":return void(0,u.reopenWithEditor)(e.uri,t.viewType,t.requireExtension);default:console.warn(`Unknown request from webview: ${JSON.stringify(t)}`)}})),t.webview.options={enableScripts:!0},t.webview.html=await(0,a.bundlePage)(t.webview.asWebviewUri(this.bundle),{MODEL:e.userData,...this.extraConsts})}async saveCustomDocument(){}async revertCustomDocument(){}async backupCustomDocument(){return{id:"",delete:()=>{}}}saveCustomDocumentAs(e,t){return s.workspace.fs.copy(e.uri,t,{overwrite:!0})}}},227:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HeapProfileAnnotations=void 0;const n=o(496),i=o(561),r=o(127),s=o(583);class a extends r.ProfileAnnotations{constructor(){super(...arguments),this.data=new Map}set(e,t,o){var r;let s=this.data.get((0,i.lowerCaseInsensitivePath)(e));s||(s=[],this.data.set((0,i.lowerCaseInsensitivePath)(e),s));let a=0;for(;a<s.length&&s[a].position.line<t.line;)a++;if((null===(r=s[a])||void 0===r?void 0:r.position.line)===t.line){const e=s[a];t.character<e.position.character&&(e.position=new n.Position(t.line,t.character)),e.data.totalSize+=o.totalSize,e.data.selfSize+=o.selfSize}else s.splice(a,0,{position:new n.Position(t.line,t.character),data:{totalSize:o.totalSize,selfSize:o.selfSize}})}getLensesForFile(e){var t,o;return this.expandForFile(e),null!==(o=null===(t=this.data.get((0,i.lowerCaseInsensitivePath)(e)))||void 0===t?void 0:t.map((({position:e,data:t})=>{if(0===t.totalSize&&0===t.selfSize)return[];const o=new n.Range(e,e);return[new n.CodeLens(o,{title:`${s.decimalFormat.format(t.selfSize/1e3)}kB Self Size, ${s.decimalFormat.format(t.totalSize/1e3)}kB Total Size`,command:""}),new n.CodeLens(o,{title:"Clear",command:"extension.jsProfileVisualizer.table.clearCodeLenses"})]})).reduce(((e,t)=>[...e,...t]),[]))&&void 0!==o?o:[]}}t.HeapProfileAnnotations=a},970:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildModel=void 0;const n=o(460),i=o(561);t.buildModel=e=>{var t;let o=[e.head];const r=(e=>{if(e.$vscode)return e.$vscode.locations;let t=0;const o=new Map,n=e=>{const n=[e.functionName,e.url,e.scriptId,e.lineNumber,e.columnNumber].join(":"),r=o.get(n);if(r)return r.id;const s=t++;return o.set(n,{id:s,callFrame:e,location:{lineNumber:e.lineNumber+1,columnNumber:e.columnNumber+1,source:{name:(0,i.maybeFileUrlToPath)(e.url),path:(0,i.maybeFileUrlToPath)(e.url),sourceReference:0}}}),s};let r=[e.head];for(;r.length;){const e=r.pop();if(e){const{callFrame:t}=e;e.locationId=n(t),r=r.concat(e.children)}}return[...o.values()].sort(((e,t)=>e.id-t.id)).map((e=>({locations:[e.location],callFrame:e.callFrame})))})(e);for(;o.length;){const t=o.pop();t&&(t.locationId&&(t.src=(0,n.getBestLocation)(e,r[t.locationId].locations)),o=o.concat(t.children))}return{head:e.head,samples:e.samples,rootPath:null===(t=e.$vscode)||void 0===t?void 0:t.rootPath}}},242:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTree=t.TreeNode=void 0;const n=o(639);class i{static root(){return new i({id:-1,selfSize:0,children:[],callFrame:{functionName:"(root)",lineNumber:-1,columnNumber:-1,scriptId:"0",url:""}})}get id(){return this.node.id}get callFrame(){return this.node.callFrame}get src(){return this.node.src}constructor(e,t){this.node=e,this.parent=t,this.children={},this.totalSize=0,this.selfSize=0,this.childrenSize=0,this.category=(0,n.categorize)(e.callFrame,void 0)}toJSON(){return{category:this.category,children:this.children,childrenSize:this.childrenSize,selfSize:this.selfSize,totalSize:this.totalSize,id:this.id,callFrame:this.callFrame,src:this.src}}}t.TreeNode=i;const r=(e,t)=>{const o=new i(e,t);e.children.forEach((e=>{const t=r(e,o);o.children[t.id]=t,o.childrenSize++})),o.selfSize=e.selfSize,o.totalSize=e.selfSize;for(const e in o.children)o.totalSize+=o.children[e].totalSize;return o};t.createTree=e=>{const t=i.root();for(const o of e.head.children){const e=r(o,t);t.children[e.id]=e,t.childrenSize++}for(const e in t.children)t.totalSize+=t.children[e].totalSize;return t}},59:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addRelativeDiskPath=void 0;const n=o(561);t.addRelativeDiskPath=(e,t)=>t.source.path&&0===t.source.sourceReference?{...t,relativePath:(0,n.properRelative)(e,t.source.path)}:t},412:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.nonceHeader=t.makeNonce=void 0;t.makeNonce=function(e=32){let t="";for(let o=0;o<e;o++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[Math.floor(62*Math.random())];return t},t.nonceHeader=e=>`<meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline'; script-src 'nonce-${e}';">`},650:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getCandidateDiskPaths=t.openLocation=void 0;const s=o(37),a=o(17),l=r(o(496)),c=o(354),u=o(561),d=async e=>{try{const t=p(e);return 0===t.type||await l.workspace.fs.stat(t.uri),!0}catch{return!1}};t.openLocation=async({rootPath:e,location:t,viewColumn:o,callFrame:n})=>{t&&await h(e,t,o)||n&&await f(n,o)||l.window.showErrorMessage("Could not find the file in your workspace")};const m=async(e,t,o,n)=>{const i=new l.Position(Math.max(0,t-1),Math.max(0,o-1));await l.window.showTextDocument(e,{viewColumn:n,selection:new l.Range(i,i)})},h=async(e,o,n)=>{const i=(0,t.getCandidateDiskPaths)(e,o.source),r=(await Promise.all(i.map(d))).findIndex((e=>e));if(-1===r)return!1;const s=p(i[r]);if(0===s.type)return await(a=s,l.commands.executeCommand(a.command,...a.args)),!0;var a;const c=await l.workspace.openTextDocument(s.uri);return await m(c,o.lineNumber,o.columnNumber,n),!0},f=async({url:e,lineNumber:t,columnNumber:o},n)=>{var i,r;let u;try{u=new URL(e)}catch{return!1}if("http:"!==u.protocol&&"https:"!==u.protocol)return!1;const d=(0,a.resolve)(null!==(r=null===(i=l.workspace.workspaceFolders)||void 0===i?void 0:i[0].uri.fsPath)&&void 0!==r?r:(0,s.tmpdir)(),u.pathname.slice(1)||"index.js"),h=await l.workspace.openTextDocument(l.Uri.file(d).with({scheme:c.DownloadFileProvider.scheme,query:e}));return await m(h,t+1,o+1,n),!0},p=e=>{const t=null==e?void 0:e.match(/^command:([\w\.]+)(?:\?(.*))?/);if(t){const[e,o]=t.slice(1),n=o?JSON.parse(decodeURIComponent(o)):[];return{type:0,command:e,args:Array.isArray(n)?n:[n]}}return(null==e?void 0:e.match(/\w\w+:/))?{type:1,uri:l.Uri.parse(e||""),isFile:!1}:{type:1,uri:l.Uri.file(e||""),isFile:!0}};t.getCandidateDiskPaths=(e,t)=>{var o;if(!t.path)return[];const n=p(t.path),i=[t.path];if(!e||0===n.type||!n.isFile)return i;for(const n of null!==(o=l.workspace.workspaceFolders)&&void 0!==o?o:[])i.push((0,a.resolve)(n.uri.fsPath,(0,u.properRelative)(e,t.path)));return i}},561:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.isWindowsPath=t.maybeFileUrlToPath=t.lowerCaseInsensitivePath=t.getCaseSensitivePaths=t.setCaseSensitivePaths=t.properRelative=void 0;const s=r(o(17));t.properRelative=function(e,t){var o,n;return(null===(o=s.posix)||void 0===o?void 0:o.isAbsolute(e))?s.posix.relative(e,t):(null===(n=s.win32)||void 0===n?void 0:n.isAbsolute(e))?s.win32.relative(e,t):s.relative(e,t)};let a="undefined"!=typeof process&&"win32"!==process.platform;t.setCaseSensitivePaths=function(e){a=e},t.getCaseSensitivePaths=function(){return a},t.lowerCaseInsensitivePath=function(e){return a?e:e.toLowerCase()},t.maybeFileUrlToPath=function(e){return e.startsWith("file:///")?(e=e.replace("file:///",""),"/"===(e=decodeURIComponent(e))[0]||e.match(/^[A-Za-z]:/)||(e="/"+e),(0,t.isWindowsPath)(e)&&(e=e[0].toLowerCase()+e.substr(1)),e):e},t.isWindowsPath=e=>/^[A-Za-z]:/.test(e)},127:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileAnnotations=t.getBasename=void 0;const n=o(496),i=o(132),r=o(650),s=/[^/\\]+$/;t.getBasename=e=>{var t,o;return null!==(o=null===(t=s.exec(e))||void 0===t?void 0:t[0])&&void 0!==o?o:e},t.ProfileAnnotations=class{constructor(){this.basenamesToExpand=new Map}add(e,o){var s;const a=(0,i.once)((()=>{this.set(o.callFrame.url,new n.Position(Math.max(0,o.callFrame.lineNumber),Math.max(0,o.callFrame.columnNumber)),o);const t=o.src;if(t&&0===t.source.sourceReference&&t.source.path&&t.source.path!==o.callFrame.url)for(const i of(0,r.getCandidateDiskPaths)(e,t.source))this.set(i,new n.Position(Math.max(0,t.lineNumber-1),Math.max(0,t.columnNumber-1)),o)}));this.addExpansionFn((0,t.getBasename)(o.callFrame.url),a),(null===(s=o.src)||void 0===s?void 0:s.source.path)&&this.addExpansionFn((0,t.getBasename)(o.src.source.path),a)}addExpansionFn(e,t){let o=this.basenamesToExpand.get(e);o||(o=[],this.basenamesToExpand.set(e,o)),o.push(t)}expandForFile(e){const o=(0,t.getBasename)(e),n=this.basenamesToExpand.get(o);if(n){for(const e of n)e();this.basenamesToExpand.delete(o)}}}},21:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileCodeLensProvider=void 0;const n=o(496),i=o(354),r=o(561);t.ProfileCodeLensProvider=class{constructor(){this.changeEmitter=new n.EventEmitter,this.onDidChangeCodeLenses=this.changeEmitter.event}registerLenses(e){return n.commands.executeCommand("setContext","jsProfileVisualizer.hasCodeLenses",!0),this.lenses=e,{dispose:()=>{this.lenses===e&&this.clear()}}}clear(){this.lenses&&(this.lenses=void 0,n.commands.executeCommand("setContext","jsProfileVisualizer.hasCodeLenses",!1),this.changeEmitter.fire())}provideCodeLenses(e){var t,o;const n=null===(t=this.lenses)||void 0===t?void 0:t.getLensesForFile((0,r.lowerCaseInsensitivePath)(e.uri.fsPath));if(n)return n;return(e.uri.scheme===i.DownloadFileProvider.scheme?null===(o=this.lenses)||void 0===o?void 0:o.getLensesForFile(e.uri.query):void 0)||[]}}},79:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ReadonlyCustomDocument=void 0,t.ReadonlyCustomDocument=class{constructor(e,t){this.uri=e,this.userData=t}dispose(){}}},802:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.reopenWithEditor=void 0;const s=r(o(496));t.reopenWithEditor=function(e,t,o,n){o&&!s.extensions.all.some((e=>e.id===o))?s.commands.executeCommand("workbench.extensions.action.showExtensionsWithIds",[o]):s.commands.executeCommand("vscode.openWith",e,t,n?s.ViewColumn.Beside:s.ViewColumn.Active)}},920:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.deactivate=t.activate=void 0;const s=r(o(496)),a=o(577),l=o(354),c=o(171),u=o(849),d=o(21);t.activate=function(e){const t=new d.ProfileCodeLensProvider;e.subscriptions.push(s.window.registerCustomEditorProvider("jsProfileVisualizer.cpuprofile.table",new a.CpuProfileEditorProvider(t,s.Uri.joinPath(e.extensionUri,"out","cpu-client.bundle.js")),{webviewOptions:{retainContextWhenHidden:!0}}),s.window.registerCustomEditorProvider("jsProfileVisualizer.heapprofile.table",new u.HeapProfileEditorProvider(t,s.Uri.joinPath(e.extensionUri,"out","heap-client.bundle.js")),{webviewOptions:{retainContextWhenHidden:!0}}),s.window.registerCustomEditorProvider("jsProfileVisualizer.heapsnapshot.table",new c.HeapSnapshotEditorProvider(s.Uri.joinPath(e.extensionUri,"out","heapsnapshot-client.bundle.js"))),s.workspace.registerTextDocumentContentProvider("js-viz-download",new l.DownloadFileProvider),s.languages.registerCodeLensProvider("*",t),s.commands.registerCommand("extension.jsProfileVisualizer.table.clearCodeLenses",(()=>t.clear())))},t.deactivate=function(){}},496:e=>{e.exports=require("vscode")},37:e=>{e.exports=require("os")},17:e=>{e.exports=require("path")}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n=o(920);module.exports=n})();